// Code generated by cmd/lexgen (see Makefile's lexgen); DO NOT EDIT.

// Lexicon schema: app.bsky.draft.defs

package bsky

import (
	"encoding/json"
	"fmt"

	comatproto "github.com/bluesky-social/indigo/api/atproto"
	lexutil "github.com/bluesky-social/indigo/lex/util"
)

// DraftDefs_Draft is a "draft" in the app.bsky.draft.defs schema.
//
// A draft containing an array of draft posts.
type DraftDefs_Draft struct {
	// langs: Indicates human language of posts primary text content.
	Langs []string `json:"langs,omitempty" cborgen:"langs,omitempty"`
	// postgateEmbeddingRules: Embedding rules for the postgates to be created when this draft is published.
	PostgateEmbeddingRules []*DraftDefs_Draft_PostgateEmbeddingRules_Elem `json:"postgateEmbeddingRules,omitempty" cborgen:"postgateEmbeddingRules,omitempty"`
	// posts: Array of draft posts that compose this draft.
	Posts []*DraftDefs_DraftPost `json:"posts" cborgen:"posts"`
	// threadgateAllow: Allow-rules for the threadgate to be created when this draft is published.
	ThreadgateAllow []*DraftDefs_Draft_ThreadgateAllow_Elem `json:"threadgateAllow,omitempty" cborgen:"threadgateAllow,omitempty"`
}

// DraftDefs_DraftEmbedCaption is a "draftEmbedCaption" in the app.bsky.draft.defs schema.
type DraftDefs_DraftEmbedCaption struct {
	Content string `json:"content" cborgen:"content"`
	Lang    string `json:"lang" cborgen:"lang"`
}

// DraftDefs_DraftEmbedExternal is a "draftEmbedExternal" in the app.bsky.draft.defs schema.
type DraftDefs_DraftEmbedExternal struct {
	Uri string `json:"uri" cborgen:"uri"`
}

// DraftDefs_DraftEmbedImage is a "draftEmbedImage" in the app.bsky.draft.defs schema.
type DraftDefs_DraftEmbedImage struct {
	Alt      *string                       `json:"alt,omitempty" cborgen:"alt,omitempty"`
	LocalRef *DraftDefs_DraftEmbedLocalRef `json:"localRef" cborgen:"localRef"`
}

// DraftDefs_DraftEmbedLocalRef is a "draftEmbedLocalRef" in the app.bsky.draft.defs schema.
type DraftDefs_DraftEmbedLocalRef struct {
	// path: Local, on-device ref to file to be embedded. Embeds are currently device-bound for drafts.
	Path string `json:"path" cborgen:"path"`
}

// DraftDefs_DraftEmbedRecord is a "draftEmbedRecord" in the app.bsky.draft.defs schema.
type DraftDefs_DraftEmbedRecord struct {
	Record *comatproto.RepoStrongRef `json:"record" cborgen:"record"`
}

// DraftDefs_DraftEmbedVideo is a "draftEmbedVideo" in the app.bsky.draft.defs schema.
type DraftDefs_DraftEmbedVideo struct {
	Alt      *string                        `json:"alt,omitempty" cborgen:"alt,omitempty"`
	Captions []*DraftDefs_DraftEmbedCaption `json:"captions,omitempty" cborgen:"captions,omitempty"`
	LocalRef *DraftDefs_DraftEmbedLocalRef  `json:"localRef" cborgen:"localRef"`
}

// DraftDefs_DraftPost is a "draftPost" in the app.bsky.draft.defs schema.
//
// One of the posts that compose a draft.
type DraftDefs_DraftPost struct {
	EmbedExternals []*DraftDefs_DraftEmbedExternal `json:"embedExternals,omitempty" cborgen:"embedExternals,omitempty"`
	EmbedImages    []*DraftDefs_DraftEmbedImage    `json:"embedImages,omitempty" cborgen:"embedImages,omitempty"`
	EmbedRecords   []*DraftDefs_DraftEmbedRecord   `json:"embedRecords,omitempty" cborgen:"embedRecords,omitempty"`
	EmbedVideos    []*DraftDefs_DraftEmbedVideo    `json:"embedVideos,omitempty" cborgen:"embedVideos,omitempty"`
	// labels: Self-label values for this post. Effectively content warnings.
	Labels *DraftDefs_DraftPost_Labels `json:"labels,omitempty" cborgen:"labels,omitempty"`
	// text: The primary post content.
	Text string `json:"text" cborgen:"text"`
}

// Self-label values for this post. Effectively content warnings.
type DraftDefs_DraftPost_Labels struct {
	LabelDefs_SelfLabels *comatproto.LabelDefs_SelfLabels
}

func (t *DraftDefs_DraftPost_Labels) MarshalJSON() ([]byte, error) {
	if t.LabelDefs_SelfLabels != nil {
		t.LabelDefs_SelfLabels.LexiconTypeID = "com.atproto.label.defs#selfLabels"
		return json.Marshal(t.LabelDefs_SelfLabels)
	}
	return nil, fmt.Errorf("can not marshal empty union as JSON")
}

func (t *DraftDefs_DraftPost_Labels) UnmarshalJSON(b []byte) error {
	typ, err := lexutil.TypeExtract(b)
	if err != nil {
		return err
	}

	switch typ {
	case "com.atproto.label.defs#selfLabels":
		t.LabelDefs_SelfLabels = new(comatproto.LabelDefs_SelfLabels)
		return json.Unmarshal(b, t.LabelDefs_SelfLabels)
	default:
		return nil
	}
}

// DraftDefs_DraftView is a "draftView" in the app.bsky.draft.defs schema.
//
// View to present drafts data to users.
type DraftDefs_DraftView struct {
	// createdAt: The time the draft was created.
	CreatedAt string           `json:"createdAt" cborgen:"createdAt"`
	Draft     *DraftDefs_Draft `json:"draft" cborgen:"draft"`
	// id: A TID to be used as a draft identifier.
	Id string `json:"id" cborgen:"id"`
	// updatedAt: The time the draft was last updated.
	UpdatedAt string `json:"updatedAt" cborgen:"updatedAt"`
}

// DraftDefs_DraftWithId is a "draftWithId" in the app.bsky.draft.defs schema.
//
// A draft with an identifier, used to store drafts in private storage (stash).
type DraftDefs_DraftWithId struct {
	Draft *DraftDefs_Draft `json:"draft" cborgen:"draft"`
	// id: A TID to be used as a draft identifier.
	Id string `json:"id" cborgen:"id"`
}

type DraftDefs_Draft_PostgateEmbeddingRules_Elem struct {
	FeedPostgate_DisableRule *FeedPostgate_DisableRule
}

func (t *DraftDefs_Draft_PostgateEmbeddingRules_Elem) MarshalJSON() ([]byte, error) {
	if t.FeedPostgate_DisableRule != nil {
		t.FeedPostgate_DisableRule.LexiconTypeID = "app.bsky.feed.postgate#disableRule"
		return json.Marshal(t.FeedPostgate_DisableRule)
	}
	return nil, fmt.Errorf("can not marshal empty union as JSON")
}

func (t *DraftDefs_Draft_PostgateEmbeddingRules_Elem) UnmarshalJSON(b []byte) error {
	typ, err := lexutil.TypeExtract(b)
	if err != nil {
		return err
	}

	switch typ {
	case "app.bsky.feed.postgate#disableRule":
		t.FeedPostgate_DisableRule = new(FeedPostgate_DisableRule)
		return json.Unmarshal(b, t.FeedPostgate_DisableRule)
	default:
		return nil
	}
}

type DraftDefs_Draft_ThreadgateAllow_Elem struct {
	FeedThreadgate_MentionRule   *FeedThreadgate_MentionRule
	FeedThreadgate_FollowerRule  *FeedThreadgate_FollowerRule
	FeedThreadgate_FollowingRule *FeedThreadgate_FollowingRule
	FeedThreadgate_ListRule      *FeedThreadgate_ListRule
}

func (t *DraftDefs_Draft_ThreadgateAllow_Elem) MarshalJSON() ([]byte, error) {
	if t.FeedThreadgate_MentionRule != nil {
		t.FeedThreadgate_MentionRule.LexiconTypeID = "app.bsky.feed.threadgate#mentionRule"
		return json.Marshal(t.FeedThreadgate_MentionRule)
	}
	if t.FeedThreadgate_FollowerRule != nil {
		t.FeedThreadgate_FollowerRule.LexiconTypeID = "app.bsky.feed.threadgate#followerRule"
		return json.Marshal(t.FeedThreadgate_FollowerRule)
	}
	if t.FeedThreadgate_FollowingRule != nil {
		t.FeedThreadgate_FollowingRule.LexiconTypeID = "app.bsky.feed.threadgate#followingRule"
		return json.Marshal(t.FeedThreadgate_FollowingRule)
	}
	if t.FeedThreadgate_ListRule != nil {
		t.FeedThreadgate_ListRule.LexiconTypeID = "app.bsky.feed.threadgate#listRule"
		return json.Marshal(t.FeedThreadgate_ListRule)
	}
	return nil, fmt.Errorf("can not marshal empty union as JSON")
}

func (t *DraftDefs_Draft_ThreadgateAllow_Elem) UnmarshalJSON(b []byte) error {
	typ, err := lexutil.TypeExtract(b)
	if err != nil {
		return err
	}

	switch typ {
	case "app.bsky.feed.threadgate#mentionRule":
		t.FeedThreadgate_MentionRule = new(FeedThreadgate_MentionRule)
		return json.Unmarshal(b, t.FeedThreadgate_MentionRule)
	case "app.bsky.feed.threadgate#followerRule":
		t.FeedThreadgate_FollowerRule = new(FeedThreadgate_FollowerRule)
		return json.Unmarshal(b, t.FeedThreadgate_FollowerRule)
	case "app.bsky.feed.threadgate#followingRule":
		t.FeedThreadgate_FollowingRule = new(FeedThreadgate_FollowingRule)
		return json.Unmarshal(b, t.FeedThreadgate_FollowingRule)
	case "app.bsky.feed.threadgate#listRule":
		t.FeedThreadgate_ListRule = new(FeedThreadgate_ListRule)
		return json.Unmarshal(b, t.FeedThreadgate_ListRule)
	default:
		return nil
	}
}
